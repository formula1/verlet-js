!function(t,s,i){function e(i,o){if(!s[i]){if(!t[i]){var r="function"==typeof require&&require;if(!o&&r)return r(i,!0);if(n)return n(i,!0);throw new Error("Cannot find module '"+i+"'")}var a=s[i]={exports:{}};t[i][0].call(a.exports,function(s){var n=t[i][1][s];return e(n?n:s)},a,a.exports)}return s[i].exports}for(var n="function"==typeof require&&require,o=0;o<i.length;o++)e(i[o]);return e}({1:[function(t){t("./verlet-polyfill");var s=t("./verlet-draw"),i=t("./verlet"),e=t("./constraint");t("./objects"),window.Vec2=t("./structures/Vec2"),window.VerletJS=i,window.VerletDraw=s,window.Particle=i.Particle;for(var n in e)window[n]=e[n]},{"./constraint":5,"./objects":6,"./structures/Vec2":7,"./verlet":4,"./verlet-draw":3,"./verlet-polyfill":2}],2:[function(){Math.sign||(Math.sign=function(t){return+t===t?0===t?t:t>0?1:-1:0/0}),Math.quadratic||(Math.quadratic=function(t,s,i){var e=s*s-4*t*i;return 0>e?!1:0==e?[-s/(2*t)]:(t*=2,e=Math.sqrt(e)/t,s*=-1/t,[s+e,s-e])}),Math.lawCos||(Math.lawCos=function(t,s,i){return Math.acos((-t*t+s*s+i*i)/(2*s*i))})},{}],7:[function(t,s){function i(t,s){this.x=t||0,this.y=s||0;var i=this;Object.defineProperty(this,"asArray",{get:function(){return[i.x,i.y]}})}s.exports=i,i.prototype.zero=function(){return this.x=0,this.y=0,this},i.prototype.posinf=function(){return this.x=Number.POSITIVE_INFINITY,this.y=Number.POSITIVE_INFINITY,this},i.prototype.neginf=function(){return this.x=Number.NEGATIVE_INFINITY,this.y=Number.NEGATIVE_INFINITY,this},i.prototype.isNaN=function(){return isNaN(this.x)?!0:isNaN(this.y)?!0:!1},i.prototype.clone=function(){return new i(this.x,this.y)},i.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},i.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},i.prototype.mul=function(t){return"number"==typeof t?this.scale(t):(this.x*=t.x,this.y*=t.y,this)},i.prototype.div=function(t){return"number"==typeof t?this.scale(1/t):(this.x/=t.x,this.y/=t.y,this)},i.prototype.scale=function(t){return this.x*=t,this.y*=t,this},i.prototype.scaleI=function(t){return this.x/=t,this.y/=t,this},i.prototype.pow=function(t){return this.x=Math.pow(this.x,t),this.y=Math.pow(this.y,t),this},i.prototype.normalize=function(){var t=this.length();return this.x/=t,this.y/=t,this},i.prototype.normal=function(){var t=Math.sqrt(this.x*this.x+this.y*this.y);return new i(this.x/t,this.y/t)},i.prototype.rotate=function(t,s){var i=this.x-t.x,e=this.y-t.y;return this.x=i*Math.cos(s)-e*Math.sin(s)+t.x,this.y=i*Math.sin(s)+e*Math.cos(s)+t.y,this},i.prototype.min=function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},i.prototype.mid=function(t){return this.x=(this.x+t.x)/2,this.y=(this.y+t.y)/2,this},i.prototype.max=function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},i.prototype.set=function(t){return this.x=t.x,this.y=t.y,this},i.prototype.swap=function(){var t=this.x;return this.x=this.y,this.y=t,this},i.prototype.equals=function(t){return this.x==t.x&&this.y==t.y},i.prototype.epsilonEquals=function(t,s){return Math.abs(this.x-t.x)<=s&&Math.abs(this.y-t.y)<=s},i.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},i.prototype.length2=function(){return this.x*this.x+this.y*this.y},i.prototype.dist=function(t){return Math.sqrt(this.dist2(t))},i.prototype.dist2=function(t){var s=t.x-this.x,i=t.y-this.y;return s*s+i*i},i.prototype.dot=function(t){return this.x*t.x+this.y*t.y},i.prototype.cross=function(t){return this.x*t.y-this.y*t.x},i.prototype.angle=function(t){return Math.atan2(this.x*t.y-this.y*t.x,this.x*t.x+this.y*t.y)},i.prototype.angle2=function(t,s){return t.clone().sub(this).angle(s.clone().sub(this))},i.prototype.slope=function(){return this.y/this.x},i.prototype.sum=function(){return this.y+this.x},i.prototype.toString=function(){return"("+this.x+", "+this.y+")"}},{}],3:[function(t,s){function i(t,s,i,n){this.width=t,this.height=s,this.canvas=i,this.ctx=i.getContext("2d"),this.mouse=new Vec2(0,0),this.mouseDown=!1,this.draggedEntity=null,this.selectionRadius=20,this.highlightColor="#4f545c",this.physics=n?n:new e(t,s);var o=this;this.physics.logic=function(){o.draggedEntity&&o.draggedEntity.pos.set(o.mouse)},this.canvas.oncontextmenu=function(t){t.preventDefault()},this.canvas.onmousedown=function(){o.mouseDown=!0;var t=o.physics.nearestEntity(o.mouse,o.selectionRadius);t&&(o.draggedEntity=t,console.log(t.pos))},this.canvas.onmouseup=function(){o.mouseDown=!1,o.draggedEntity=null},this.canvas.onmousemove=function(t){var s=o.canvas.getBoundingClientRect();o.mouse.x=t.clientX-s.left,o.mouse.y=t.clientY-s.top}}window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)};var e=t("./verlet.js");s.exports=i,i.prototype.draw=function(){var t,s;this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);var i=this.physics.composites;for(s in i){if(i[s].drawConstraints)i[s].drawConstraints(this.ctx,i[s]);else{var e=i[s].constraints;for(t in e)e[t].draw(this.ctx)}if(i[s].drawParticles)i[s].drawParticles(this.ctx,i[s]);else{var n=i[s].particles;for(t in n)n[t].draw(this.ctx)}}var o=this.draggedEntity||this.physics.nearestEntity(this.mouse,this.selectionRadius);o&&(this.ctx.beginPath(),this.ctx.arc(o.pos.x,o.pos.y,8,0,2*Math.PI),this.ctx.strokeStyle=this.highlightColor,this.ctx.stroke())}},{"./verlet.js":4}],4:[function(t,s,i){function e(t,s){this.width=t,this.height=s,this.bounds=function(t){t.pos.y>this.height-1&&(t.pos.y=this.height-1),t.pos.x<0&&(t.pos.x=0),t.pos.x>this.width-1&&(t.pos.x=this.width-1)},this.gravity=new n(0,.2),this.friction=.99,this.groundFriction=.8,this.composites=[]}var n=t("./structures/Vec2"),o=t("./collision/collision");i=s.exports=e,i.Particle=t("./structures/Particle");var r=i.Composite=t("./structures/Composite");i.Composite=r,e.prototype.Composite=r,e.prototype.logic=function(){throw new Error("Logic hasn't been set")},e.prototype.frame=function(t){var s,i,e,n;for(e in this.composites){n=this.composites[e].particles;for(s in n)n[s].lastPos.set(n[s].pos),n[s].pos.add(this.gravity),n[s].pos.add(n[s].vel)}this.logic();var r=1/t;for(e in this.composites){var a=this.composites[e].constraints;for(s=0;t>s;++s)for(i in a)a[i].relax(r)}for(e in this.composites){n=this.composites[e].particles;for(s in n)this.bounds(n[s]),n[s].vel.set(n[s].pos).sub(n[s].lastPos).scale(this.friction),n[s].pos.y>=this.height-1&&n[s].vel.length2()>1e-6&&n[s].vel.scale(this.groundFriction)}for(var h,c=this.composites.length;c--;)for(h=c;h--;)o(this.composites[c],this.composites[h],t)},e.prototype.nearestEntity=function(t,s){var i,e,n=0,o=null,r=null;for(i in this.composites){var a=this.composites[i].particles;for(e in a){var h=a[e].pos.dist2(t);s*s>=h&&(null==o||n>h)&&(o=a[e],r=this.composites[i].constraints,n=h)}}for(e in r)r[e]instanceof PinConstraint&&r[e].a==o&&(o=r[e]);return o}},{"./collision/collision":8,"./structures/Composite":10,"./structures/Particle":9,"./structures/Vec2":7}],5:[function(t,s,i){t("./structures/Vec2"),i.DistanceConstraint=t("./constraints/DistanceConstraint"),i.PinConstraint=t("./constraints/PinConstraint"),i.AngleConstraint=t("./constraints/AngleConstraint"),i.MidpointAreaConstraint=t("./constraints/AreaConstraint"),i.ScaledAreaConstraint=t("./constraints/InflateAreaConstraint")},{"./constraints/AngleConstraint":13,"./constraints/AreaConstraint":14,"./constraints/DistanceConstraint":11,"./constraints/InflateAreaConstraint":15,"./constraints/PinConstraint":12,"./structures/Vec2":7}],6:[function(t){var s=t("./verlet"),i=s.Particle,e=t("./constraint"),n=e.DistanceConstraint;s.prototype.point=function(t){var s=new this.Composite;return s.particles.push(new i(t)),this.composites.push(s),s},s.prototype.lineSegments=function(t,s,e){var o,r=new this.Composite;for(o in t)r.particles.push(new i(t[o])),o>0&&r.constraints.push(new n(r.particles[o],r.particles[o-1],s));return e&&r.constraints.push(new n(r.particles[r.particles.length-1],r.particles[0],s)),this.composites.push(r),r},s.prototype.cloth=function(t,s,e,o,r,a){var h,c,l=new this.Composite,p=s/o,u=e/o;for(c=0;o>c;++c)for(h=0;o>h;++h){var f=t.x+h*p-s/2+p/2,y=t.y+c*u-e/2+u/2;l.particles.push(new i(new Vec2(f,y))),h>0&&l.constraints.push(new n(l.particles[c*o+h],l.particles[c*o+h-1],a)),c>0&&l.constraints.push(new n(l.particles[c*o+h],l.particles[(c-1)*o+h],a))}for(h=0;o>h;++h)0==h%r&&l.pin(h);return this.composites.push(l),l},s.prototype.tire=function(t,s,e,o,r){var a,h=2*Math.PI/e,c=new this.Composite;for(a=0;e>a;++a){var l=a*h;c.particles.push(new i(new Vec2(t.x+Math.cos(l)*s,t.y+Math.sin(l)*s)))}var p=new i(t);for(c.particles.push(p),a=0;e>a;++a)c.constraints.push(new n(c.particles[a],c.particles[(a+1)%e],r)),c.constraints.push(new n(c.particles[a],p,o)),c.constraints.push(new n(c.particles[a],c.particles[(a+5)%e],r));return this.composites.push(c),c}},{"./constraint":5,"./verlet":4}],10:[function(t,s){function i(){this.particles=[],this.constraints=[],this.drawParticles=null,this.drawConstraints=null}i.prototype.pin=function(t,s){s=s||this.particles[t].pos;var i=new PinConstraint(this.particles[t],s);return this.constraints.push(i),i},s.exports=i},{}],11:[function(t,s){function i(t,s,i,e){this.a=t,this.b=s,this.distance="undefined"!=typeof e?e:t.pos.clone().sub(s.pos).length(),this.stiffness=i}i.prototype.relax=function(t){var s=this.a.pos.clone().sub(this.b.pos),i=s.length2();s.scale((this.distance*this.distance-i)/i*this.stiffness*t),this.a.pos.add(s),this.b.pos.sub(s)},i.prototype.draw=function(t){t.beginPath(),t.moveTo(this.a.pos.x,this.a.pos.y),t.lineTo(this.b.pos.x,this.b.pos.y),t.strokeStyle="#d8dde2",t.stroke()},s.exports=i},{}],13:[function(t,s){function i(t,s,i,e){this.a=t,this.b=s,this.c=i,this.angle=this.b.pos.angle2(this.a.pos,this.c.pos),this.stiffness=e}i.prototype.relax=function(t){var s=this.b.pos.angle2(this.a.pos,this.c.pos),i=s-this.angle;i<=-Math.PI?i+=2*Math.PI:i>=Math.PI&&(i-=2*Math.PI),i*=t*this.stiffness,this.a.pos.rotate(this.b.pos,i),this.c.pos.rotate(this.b.pos,-i),this.b.pos.rotate(this.a.pos,i),this.b.pos.rotate(this.c.pos,-i)},i.prototype.draw=function(t){t.beginPath(),t.moveTo(this.a.pos.x,this.a.pos.y),t.lineTo(this.b.pos.x,this.b.pos.y),t.lineTo(this.c.pos.x,this.c.pos.y);var s=t.lineWidth;t.lineWidth=5,t.strokeStyle="rgba(255,255,0,0.2)",t.stroke(),t.lineWidth=s},s.exports=i},{}],8:[function(t,s){function i(t,s,i){for(var o=new n,r=new n,a=t.particles.length;a--;)o.digestPoint(t.particles[a].pos);for(a=s.particles.length;a--;)r.digestPoint(s.particles[a].pos);if(!o.intersectsAABB(r))return!1;var h=o.sub(o),c=h.getSuspects(t.particles),l=h.getSuspects(s.particles);if(0==c.lines.length||0==l.lines.length)return!1;if(0==c.inside.length&&0==l.inside.length)return!1;for(var p,a=c.inside.length;a--;)for(p=l.lines.length;p--;){var u=l.lines[p][2].intersectsLineSegment(c.inside[a][1]);if(u||(u=l.lines[p][2].intersectsLineSegment(c.inside[a][2]))){var f=t.particles[c.inside[a][0]],y=s.particles[l.lines[p][0]],x=s.particles[l.lines[p][1]],d=e(f,y,x);if(d){if(2==d.length)if(d[0]>0){if(d[1]>0)return!1;d=d[1]}else d=d[1]>0?d[0]:Math.max(d[0],d[1]);else d=d[0];if(Math.abs(d)>i)return!1;y.pos.add(y.vel.clone().scale(d)),x.pos.add(x.vel.clone().scale(d)),f.pos.add(f.vel.clone().scale(d));var g=l.lines[p][2].length,m=y.pos.dist(f.pos),v=x.pos.dist(f.pos),w=y.vel.clone().scale(m/g).add(x.vel.clone().scale(v/g));w.add(f.vel).scale(.5),f.vel.set(w),0!=m&&y.vel.set(w.clone().sub(w.clone().scale(v/g)).scale(g/m)),0!=v&&x.vel.set(w.clone().sub(w.clone().scale(m/g)).scale(g/v)),y.pos.add(y.vel.clone().scale(i-d)),x.pos.add(x.vel.clone().scale(i-d)),f.pos.add(f.vel.clone().scale(i-d))}else console.log("no good time")}}console.log("collision solved")}function e(t,s,i){var e=t.pos,n=s.pos,o=i.pos,r=t.vel,a=s.vel,h=i.vel,c=h.cross(a)+r.cross(a.clone().sub(h)),l=e.clone().cross(a.clone().sub(h))+r.cross(n.clone().sub(o))+n.cross(h)+o.cross(a)+2*n.cross(a),p=e.cross(n.clone().sub(o))+o.x*o.y-n.x*n.y;if(0===c)return[-p/l];var u=Math.pow(l,2)-4*c*p;if(0>u)return console.log("QuadraticTime: b^2 - 4ac < 0"),!1;if(0==u)return[-l/(2*c)];console.log(Math.sqrt(u));var f=(-l-Math.sqrt(u))/(2*c),y=(-l+Math.sqrt(u))/(2*c);return[f,y]}var n=t("../structures/AABB");s.exports=i},{"../structures/AABB":16}],9:[function(t,s){function i(t){this.pos=(new e).set(t),this.lastPos=(new e).set(t),this.vel=new e}var e=t("./Vec2");i.prototype.draw=function(t){t.beginPath(),t.arc(this.pos.x,this.pos.y,2,0,2*Math.PI),t.fillStyle="#2dad8f",t.fill()},s.exports=i},{"./Vec2":7}],12:[function(t,s){function i(t,s){this.a=t,this.pos=(new e).set(s)}var e=t("../structures/Vec2");i.prototype.relax=function(){this.a.pos.set(this.pos)},i.prototype.draw=function(t){t.beginPath(),t.arc(this.pos.x,this.pos.y,6,0,2*Math.PI),t.fillStyle="rgba(0,153,255,0.1)",t.fill()},s.exports=i},{"../structures/Vec2":7}],14:[function(t,s){function i(t,s){if(Array.isArray(t)||(t=Array.prototype.slice.call(arguments,0),s=t.pop()),t.length<3)throw new Error("need at least three points in args or as an array to retain an area");if(this.points=o(t),this.area=this.points.getArea(),this.storedarea=0,this.storedmid=0,this.storedaabb=new r,!this.area||0==this.area)throw new Error("cannot calculate a nonexistant area");this.stiffness=s}var e=t("../structures/Vec2"),n=t("../structures/Triangle"),o=t("../structures/Polygon"),r=t("../structures/AABB");i.prototype.relax=function(t){var s=0,i=new e,o=this.points.length;if(this.points.forThree(function(t,e,n){s+=e.cross(n),i.add(e.clone().scale(1/o))}),0>=s)throw alert("negative area"),new Error("negative area");var r=Math.sqrt((this.area*this.stiffness*t+(1-this.stiffness*t)*s)/s);this.storedarea=0,this.storedmid=new e;var a=this;this.points.forThree(function(t,s,e,h){var c=!0,l=new n(t,s,e);if(l.isConcave()){l.hasPoint(a.storedmid)&&(problem=!0);var p=a.points.getIntersects(t,s,h);p.length>0&&(c=!1)}a.storedmid.add(s.sub(i).scale(r).add(i).clone().scale(1/o)),s!=a.points[0]&&(a.storedarea+=t.cross(s)),a.storedaabb.digestPoint(s)})},i.prototype.draw=function(t){var s=Math.floor(Math.min(255,255*this.area/this.storedarea)),i=Math.floor(Math.min(255,255*this.storedarea/this.area));t.beginPath(),t.moveTo(this.points[0].x,this.points[0].y);var e=this,o=!1,r=[];this.points.forThree(function(s,i,a,h){var c=new n(s,i,a);c.isConcave()&&c.hasPoint(e.storedmid)&&(o=!0);var l=e.points.getIntersects(s,i,h);l.length>0&&(r=r.concat(l)),t.lineTo(i.x,i.y)});var a=i>s?s:i;t.closePath(),t.fillStyle="rgba("+s+","+a+","+i+",0.6)",t.fill();for(var h=r.length;h--;)t.beginPath(),t.arc(r[h].x,r[h].y,8,0,2*Math.PI,!1),t.fillStyle="#FF8300",t.fill();var c=this.points.getDelaney();for(h=c.length;h;)t.beginPath(),--h,t.moveTo(this.points[c[h]].x,this.points[c[h]].y),--h,t.lineTo(this.points[c[h]].x,this.points[c[h]].y),--h,t.lineTo(this.points[c[h]].x,this.points[c[h]].y),t.closePath(),t.stroke();t.beginPath(),t.arc(this.storedmid.x,this.storedmid.y,2,0,2*Math.PI,!1),t.fillStyle=o?"#FF0000":"#00FF00",t.fill()},s.exports=i},{"../structures/AABB":16,"../structures/Polygon":18,"../structures/Triangle":17,"../structures/Vec2":7}],15:[function(t,s){function i(t,s){if(Array.isArray(t)||(t=Array.prototype.slice.call(arguments,0),s=t.pop()),t.length<3)throw new Error("need at least three points in args or as an array to retain an area");if(this.points=r(t),this.area=this.points.getArea(),this.storedarea=0,this.storedmid=0,this.storedaabb=new a,!this.area||0==this.area)throw new Error("cannot calculate a nonexistant area");this.stiffness=s}var e=t("../structures/Vec2"),n=t("../structures/Line"),o=t("../structures/Triangle"),r=t("../structures/Polygon"),a=t("../structures/AABB");i.prototype.relax=function(t){var s=0,i=new e,n=this.points.length;if(this.points.forThree(function(t,e,o){s+=e.cross(o),i.add(e.clone().scale(1/n))}),0>=s)throw alert("negative area"),new Error("negative area");var o=(this.area*this.stiffness*t+(1-this.stiffness*t)*s)/s;this.points[this.points.length-1],this.points[0].clone();var r=this.points[this.points.length-1],a=new e;for(this.points.forThree(function(t,s){var i=s.clone();s.sub(r).scale(o).add(t),a.add(s.clone().scale(1/n)),r=i});n--;)this.points[n].sub(a).add(i);this.storedarea=s*o,this.storedmid=i},i.prototype.draw=function(t){var s=Math.floor(Math.min(255,255*this.area/this.storedarea)),i=Math.floor(Math.min(255,255*this.storedarea/this.area)),e=this,r=!1,a=[],h=!1,c=[],l=this.points.length-1;for(t.beginPath(),t.moveTo(this.points[l].x,this.points[l].y);l--;)t.lineTo(this.points[l].x,this.points[l].y);var p=i>s?s:i;t.closePath(),t.fillStyle="rgba("+s+","+p+","+i+",0.6)",t.fill(),t.lineWidth=4,this.points.forThree(function(s,i,l,p){if(i.equals(l))return h=h||s,void 0;h&&(s=h,h=!1),c.push(i);var u=new o(s,i,l),f=u.getConcaveBisector(),y=!1;u.CA.pointIsLeftOrTop(f.B)==u.CA.pointIsLeftOrTop(u.B)?(t.strokeStyle="#FFFF00",u.hasPoint(e.storedmid)&&(r=!0)):(t.strokeStyle="#FF00FF",u.partialArea<0&&(y=!0));var x=e.points.intersectsLine(new n(s,i),p);x.length>0&&(a=a.concat(x)),t.beginPath(),t.moveTo((s.x+i.x)/2,(s.y+i.y)/2),t.lineTo(i.x,i.y),t.lineTo((l.x+i.x)/2,(l.y+i.y)/2),t.stroke()}),t.lineWidth=1;for(var u=a.length;u--;)t.beginPath(),t.arc(a[u].x,a[u].y,8,0,2*Math.PI,!1),t.fillStyle="#FF8300",t.fill();t.beginPath(),t.arc(this.storedmid.x,this.storedmid.y,2,0,2*Math.PI,!1),t.fillStyle=r?"#FF0000":"#00FF00",t.fill()},s.exports=i},{"../structures/AABB":16,"../structures/Line":19,"../structures/Polygon":18,"../structures/Triangle":17,"../structures/Vec2":7}],16:[function(t,s){function i(t){if(this.max=(new e).neginf(),this.min=(new e).posinf(),t)if(arguments.length>1)for(var s=arguments.length;s--;)this.digestPoint(arguments[s]);else for(var s=t.length;s--;)this.digestPoint(t[s])}var e=t("./Vec2"),n=t("./Line");i.prototype.digestPoint=function(t){this.max.max(t),this.min.min(t)},i.prototype.intersectsAABB=function(t){return this.min.x>=t.max.x?!1:this.min.y>=t.max.y?!1:t.min.x>=this.max.x?!1:t.min.y>=this.max.y?!1:!0},i.prototype.sub=function(t){return this.min.max(t.min),this.max.min(t.max),this},i.prototype.getSuspects=function(t){for(var s,i,e,o=[],r=[],a=[],h=t.length,c=h,l=!1,p=!1;h--;)l=t[h].pos.x<=this.max.x&&t[h].pos.x>=this.min.x,p=t[h].pos.y<=this.max.y&&t[h].pos.y>=this.min.y,l&&p?(i=new Array(3),i[0]=h,s=(h+c-1)%c,i[1]=new n(t[s].pos,t[h].pos),-1==a.indexOf(s+"|"+h)&&(o.push([s,h,i[1]]),a.push(s+"|"+h)),e=(h+1)%c,i[2]=new n(t[h].pos,t[e].pos),-1==a.indexOf(h+"|"+e)&&(o.push([h,e,i[2]]),a.push(h+"|"+e)),r.push(i)):(l||p)&&(s=(h+c-1)%c,-1==a.indexOf(s+"|"+h)&&(i=new n(t[s].pos,t[h].pos),this.intersectsLine(i)&&o.push([s,h,i]),a.push(s+"|"+h)),e=(h+1)%c,-1==a.indexOf(h+"|"+e)&&(i=new n(t[h].pos,t[e].pos),this.intersectsLine(i)&&o.push([h,e,i]),a.push(h+"|"+e)));return{inside:r,lines:o}},i.prototype.containsPoint=function(t){return t.x>=this.max.x?!1:t.y>=this.max.y?!1:t.x<=this.min.x?!1:t.y<=this.min.y?!1:!0},i.prototype.intersectsLine=function(t){var s=new n(this.max,new e(this.min.x,this.max.y)),i=s.intersectsLineSegment(t);return i&&this.containsPoint(i)?!0:(s=new n(this.max,new e(this.max.x,this.min.y)),i=s.intersectsLineSegment(t),i&&this.containsPoint(i)?!0:(s=new n(this.min,new e(this.max.x,this.min.y)),i=s.intersectsLineSegment(t),i&&this.containsPoint(i)?!0:(s=new n(this.min,new e(this.min.x,this.max.y)),i=s.intersectsLineSegment(t),i&&this.containsPoint(i)?!0:!1)))},i.prototype.intersectsCircle=function(t){return t.containsPoint(this.max)?!0:t.containsPoint(this.min)?!0:t.containsPoint(new e(this.min.x,this.max.y))?!0:t.containsPoint(new e(this.max.x,this.min.y))?!0:!1},s.exports=i},{"./Line":19,"./Vec2":7}],18:[function(t,s){function i(t){for(var s=t.length,e=s,n=Array(e);e--;)n[s-e-1]=t[e].pos||t[e];for(var e in i.prototype)Object.defineProperty(n,e,{enumerable:!1,value:i.prototype[e].bind(n)});return n}i.prototype.clone=function(){var t=this.slice(0);for(var s in i.prototype)Object.defineProperty(t,s,{enumerable:!1,value:i.prototype[s].bind(t)});return t},i.prototype.forThree=function(t,s){for(var i=this.length,e=i-(s||0);e--;){var n=(e+1)%i,o=e,r=(e+i-1)%i;t.call(this,this[n],this[o],this[r],o)}};var e=t("./cacheable");for(var n in e)i.prototype[n]=e[n];var o=t("./intersects");for(var n in o)i.prototype[n]=o[n];s.exports=i},{"./cacheable":20,"./intersects":21}],19:[function(t,s){function i(t,s){if(t.equals(s))throw new Error("cannot construct line when A == B");this.A=t,this.B=s,this.angledSlope=t.clone().sub(s).normalize(),this.slope=this.angledSlope.scale(Math.sign(this.angledSlope.x)||Math.sign(this.angledSlope.y)),this.inv_slope=0==this.slope.y?!1:this.slope.x/this.slope.y,this.true_slope=0==this.slope.x?!1:this.slope.y/this.slope.x,this.yint=this.true_slope!==!1?-this.true_slope*t.x+t.y:!1,this.xint=this.inv_slope!==!1?-this.inv_slope*t.y+t.x:!1,this.mid=t.clone().mid(s),this.length2=t.dist2(s),this.length=Math.sqrt(this.length2),this.cross=t.cross(s)}t("../Vec2"),i.prototype.toString=function(){return"limits:["+A+","+B+"],"+"intercepts:("+this.yint+","+thisxint+")"};var e=t("./intersects.js");for(var n in e)i.prototype[n]=e[n];var o=t("./questions.js");for(var n in o)i.prototype[n]=o[n];i.prototype.perpendicularBisector=function(){var t=this.mid,s=this.A.clone().sub(t).swap(),e=s.clone();return s.y*=-1,e.x*=-1,s.add(t),e.add(t),new i(s,e)},s.exports=i},{"../Vec2":7,"./intersects.js":22,"./questions.js":23}],17:[function(t,s){function i(t,s,i){if(t.equals(s)||s.equals(i)||i.equals(t))throw new Error("cannot create triangle when two points are the same");this.A=t,this.B=s,this.C=i,this.AB=new e(t,s),this.BC=new e(s,i),this.CA=new e(i,t),this.ABC=Math.lawCos(this.CA.length,this.AB.length,this.BC.length),this.BCA=Math.asin(Math.sin(this.ABC)*this.CA.length/this.AB.length),this.CAB=Math.asin(Math.sin(this.ABC)*this.BC.length/this.AB.length),this.perimiter=this.AB.length+this.BC.length+this.CA.length,this.partialArea=this.AB.cross+this.BC.cross+this.CA.cross,this.area=Math.abs(this.partialArea)}t("../Vec2");var e=t("../Line"),n=t("./intersections.js");for(var o in n)i.prototype[o]=n[o];var r=t("./questions.js");for(var o in r)i.prototype[o]=r[o];var a=t("./cacheable.js");i.prototype.getConcaveBisector=a.getConcaveBisector,s.exports=i},{"../Line":19,"../Vec2":7,"./cacheable.js":26,"./intersections.js":24,"./questions.js":25}],24:[function(t,s){var i={};i.hasPoint=function(t){var s=this.C.clone().sub(this.B),i=this.A.clone().sub(this.B),e=t.clone().sub(this.B),n=s.dot(s),o=s.dot(i),r=s.dot(e),a=i.dot(i),h=i.dot(e),c=1/(n*a-o*o),l=(a*r-o*h)*c,p=(n*h-o*r)*c;return l>=0&&p>=0&&1>l+p},s.exports=i},{}],25:[function(t,s){var i={},e=Math.pow(2,.5);i.isConcave=function(t,s,i){var e=new Line(t,i);return e.pointIsLeftOrTop(e.perpendicularBisector().A)==e.pointIsLeftOrTop(s)},i.anglePrimer=function(){return this.CA.length-e*(this.AB.length+this.BC.length)/2},i.isAcute=function(){return this.anglePrimer()<0},i.isObtuse=function(){return this.anglePrimer()>0},i.isRight=function(){return 0==this.anglePrimer()},i.equals=function(t){return this.A.equals(t.A)&&this.B.equals(t.B)&&this.C.equals(t.C)},i.epsilonEquals=function(t,s){return this.A.epsilonEquals(t.A,s)&&this.B.epsilonEquals(t.B,s)&&this.C.epsilonEquals(t.C,s)},i.equalShape=function(t){return this.area==t.area&&this.perimiter==t.perimiter},i.epsilonEqualShape=function(t,s){return Math.abs(this.area-t.area)/27<=s&&Math.abs(this.perimiter-t.perimiter)/9<=s},i.equalAngles=function(t){for(var s,i=["ABC","BCA","CAB"],e=3;e--;){for(s=3;s--&&this[i[e]]!=t[i[e]];);if(0>s)return!1}return!0},s.exports=i},{}],26:[function(t,s){var i={};i.getConcaveBisector=function(){return this.CA.perpendicularBisector()},i.AB=function(){return new Line(this.A,this.B)},i.BC=function(){return new Line(B,C)},i.CA=function(){return new Line(C,A)},i.ABC=function(){return Math.lawCos(this.CA.length,this.AB.length,this.BC.length)},i.BCA=function(){return Math.asin(Math.sin(this.ABC)*this.CA.length/this.AB.length)},i.CAB=function(){return Math.asin(Math.sin(this.ABC)*this.BC.length/this.AB.length)},i.perimiter=function(){return this.AB.length+this.BC.length+this.CA.length},i.partialArea=function(){return this.AB.cross+this.BC.cross+this.CA.cross},i.area=function(){return Math.abs(this.partialArea)},s.exports=i},{}],23:[function(t,s){var i={};i.equals=function(t){return this.A.equals(t.A)&&this.B.equals(t.B)},i.epsilonEquals=function(t,s){return this.A.epsilonEquals(t.A,s)&&this.B.epsilonEquals(t.B,s)},i.equalSlope=function(t){return this.slope.equals(t.slope)&&this.xint?this.xint==t.xint:this.yint==t.yint},i.epsilonEqualSlope=function(t,s){return this.slope.epsilonEquals(t.slope,s)&&this.xint?Math.abs(this.xint-t.xint)<=s:Math.abs(this.yint-t.yint)<=s},i.equalMagnitude=function(t){return this.slope.equals(t.slope)&&this.length==t.length},i.epsilonEqualMagnitude=function(t,s){return this.slope.epsilonEquals(t.slope,s)&&Math.abs(this.length-t.length)<=s},s.exports=i},{}],22:[function(t,s){var i=t("../Vec2"),e={};e.intersectsLine=function(t){var s=this;if(s.slope.equals(t.slope))return!1;var e=new i;if(0===s.slope.x||0===t.slope.x){if(0===s.slope.y||0===t.slope.y)return new i(0===s.slope.x?s.xint:t.xint,0===s.slope.y?s.yint:t.yint);e.y=(s.xint-t.xint)/(t.inv_slope-s.inv_slope),e.x=s.inv_slope*e.y+s.xint}else e.x=(s.yint-t.yint)/(t.true_slope-s.true_slope),e.y=s.true_slope*e.x+s.yint;return e},e.intersectsLineSegment=function(t){var s=this.intersectsLine(t);return s?(new i).posinf().min(this.A).min(this.B).max(s).equals(s)?(new i).neginf().max(this.A).max(this.B).min(s).equals(s)?(new i).posinf().min(t.A).min(t.B).max(s).equals(s)?(new i).neginf().max(t.A).max(t.B).min(s).equals(s)?s:!1:!1:!1:!1:!1},e.pointIsLeftOrTop=function(t){return this.B.clone().sub(this.A).cross(t.clone().sub(this.A))<0},e.intersectsPoint=function(t){return this.slope.x?t.y==t.x*this.slope.slope()+this.yint:this.xint==t.x},s.exports=e},{"../Vec2":7}],20:[function(t,s){var i=t("../Vec2"),e={};e.getMidPoint=function(){for(var t=this.length,s=new i,e=this.length;e--;)s.add(this[e].clone().scale(1/t));return s},e.getArea=function(){var t=0;return this.forThree(function(s,i,e){t+=i.cross(e)}),t},e.getAABB=function(){for(var t=new i(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),s=new i(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),e=this.length;e--;)t.max(this[e]),s.min(this[e]);return{max:t,min:s}},s.exports=e},{"../Vec2":7}],21:[function(t,s){var i=t("../AABB"),e=t("../Line"),n={};n.intersectsLine=function(t,s){var n=new i(t.A,t.B),o=[];return this.forThree(function(s,r){if(t.A!=r&&t.B!=s&&s!=t.A){var a=new i(s,r);if(n.intersectsAABB(a)){var h=t.intersectsLine(new e(s,r));h&&({max:a.max.min(n.max),min:a.min.max(n.min)},n.containsPoint(h)&&o.push(h))}}},s),o},s.exports=n},{"../AABB":16,"../Line":19}]},{},[1]);